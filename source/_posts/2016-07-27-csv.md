title: csv
toc: false
date: 2016-07-27 18:59:36
tags:
  - csv
categories:
  - PHP工具
---

PHP导入导出CSV
<!--more-->

# 导出CSV

```PHP
function export_csv ($data) {
    $filename = date('YmdHis').".csv";//文件名
    header("Content-type:text/csv");
    header("Content-Disposition:attachment;filename=".$filename);
    header('Cache-Control:must-revalidate,post-check=0,pre-check=0');
    header('Expires:0');
    header('Pragma:public');
    if (is_string($data)) {
      echo i($data);
    } elseif (is_array($data)){
      echo array2string($data);
    } else {
      echo '不支持的数据类型'
    }
}

function array2string ($data) {
    $csv ='';
    $size = count($data);
    for($i = 0 ; $i < $size ; $i++) {
      $lineCount = count($data[$i]);
      foreach ($data[$i] as )
      $csv .= i($result[$i][0]).','.i($result[$i][1])."\n";
    }
    foreach ($data as $lineData) {
      foreach ($lineData as $line) {
        $csv .= i($line).',';
      }
      $csv = rtrim($csv, ',') . "\n"; // 双引号的\n
    }
    return $csv;
}

function i($strInput) {
    return iconv('utf-8','GB2312//IGNORE',$strInput);//页面编码为utf-8时使用，否则导出的中文为乱码
}
```
